# Запуск AI-Репетитора в Docker

Этот документ содержит инструкции по запуску проекта AI-Репетитор в Docker-контейнере.

## Предварительные требования

- Docker
- Docker Compose
- Telegram Bot Token
- OpenRouter API ключ

## Шаги по запуску

### 1. Настройка переменных окружения

Создайте файл `.env` в корневой директории проекта со следующими переменными:

```
# Telegram
TELEGRAM_TOKEN=your_telegram_bot_token

# Neo4j
NEO4J_USER=neo4j
NEO4J_PASSWORD=your_password

# OpenRouter
OPENROUTER_API_KEY=your_openrouter_api_key
```

### 2. Сборка и запуск контейнеров

```bash
docker-compose up -d
```

Эта команда запустит:
- AI-Репетитора в контейнере
- Neo4j базу данных

### 3. Проверка работоспособности

После запуска контейнеров:
1. Убедитесь, что Neo4j доступен по адресу http://localhost:7474
2. Проверьте логи бота:
   ```bash
   docker-compose logs -f ai-tutor
   ```
3. Найдите вашего бота в Telegram и отправьте команду `/start`

### 4. Остановка контейнеров

```bash
docker-compose down
```

## Работа только с ботом (без Neo4j)

Если у вас уже есть работающая база Neo4j, вы можете запустить только контейнер с ботом:

```bash
docker-compose up -d ai-tutor
```

При этом не забудьте указать правильный URL для подключения к Neo4j в переменной окружения `NEO4J_URI`.

## Первичная загрузка данных

Если вы запускаете проект впервые и база данных пуста, необходимо загрузить данные курса:

```bash
# Подключитесь к контейнеру
docker-compose exec ai-tutor bash

# Запустите скрипт загрузки данных
python -c "from ai_tutor.database.neo4j_client import Neo4jClient; client = Neo4jClient(); client.load_course_data('course.txt')"
```

## Устранение проблем

### Проблемы с подключением к Neo4j

Убедитесь, что:
1. Контейнер Neo4j запущен
2. Параметры подключения (URI, пользователь, пароль) указаны верно
3. В логах Neo4j нет ошибок

### Бот не отвечает на сообщения

Проверьте:
1. Правильность Telegram токена
2. Логи контейнера с ботом
3. Подключение к Neo4j

### Проблемы с генерацией задач

Убедитесь, что:
1. OpenRouter API ключ указан верно
2. Выбранная модель доступна
3. В базе данных Neo4j есть необходимые данные курса 